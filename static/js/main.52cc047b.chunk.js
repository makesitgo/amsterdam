(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{216:function(e,n){},218:function(e,n){},235:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(23),c=t(2),s=t(24),i=t(113),l=t.n(i),d=t(46),u=t(16),b=t(8),j=t(13),f=t(10),m=t(7),g=t(14),O=t(78),h=t(5),p=Object(r.createContext)(null),x=function(e){var n=e.children,t=new O.a({id:"amsterdam-ussnf"}),a=Object(r.useState)(t.currentUser),o=Object(j.a)(a,2),c=o[0],s=o[1],i=function(){var e=Object(g.a)(Object(m.a)().mark((function e(n,r){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.logIn(O.b.emailPassword(n,r));case 3:return s(t.currentUser),e.abrupt("return",t.currentUser);case 7:return e.prev=7,e.t0=e.catch(0),console.error("failed to login",e.t0),s(null),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(n,t){return e.apply(this,arguments)}}(),l=function(){var e=Object(g.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("logging in anonymously"),e.next=4,t.logIn(O.b.anonymous());case 4:return s(t.currentUser),e.abrupt("return",t.currentUser);case 8:return e.prev=8,e.t0=e.catch(0),console.error("failed to login",e.t0),s(null),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(g.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.currentUser){e.next=4;break}return e.next=4,t.currentUser.logOut();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("failed to logout",e.t0);case 9:return e.prev=9,s(null),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(p.Provider,{value:{login:i,loginAnonymous:l,logout:d,user:c},children:n})},v=function(){var e=Object(r.useContext)(p);if(null===e)throw new Error("useRealm() called outside of a RealmProvider");return e},y=Object(r.createContext)(null),w=function(e){var n=e.children,t=v().user,a=Object(r.useState)(null),o=Object(j.a)(a,2),c=o[0],s=o[1];return Object(r.useEffect)((function(){console.log("on user effect...setting data"),null!==t&&(console.log(t),console.log(t.profile),s(t.mongoClient("data")))}),[t]),Object(h.jsx)(y.Provider,{value:{data:z(c)},children:n})},k=function(){var e=Object(r.useContext)(y);if(null===e)throw new Error("useAtlas() called outside of a AtlasProvider");return e};function z(e){return e?{players:function(){return e.db("amsterdam").collection("players")},schedule:function(){return e.db("amsterdam").collection("schedule")},seasons:function(){return e.db("amsterdam").collection("seasons")},teams:function(){return e.db("amsterdam").collection("teams")},teamMatches:function(){return e.db("amsterdam").collection("team_matches")}}:null}var C,S,_,A=t(15),L=t(17),E=t(35),P=t(89),I=t(25),M=L.a.div(C||(C=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]))),T=L.a.div(S||(S=Object(A.a)(["\n  min-width: 360px;\n  padding: 1rem;\n  border: 1px solid;\n"]))),q=L.a.div(_||(_=Object(A.a)(["\n  min-width: 360px;\n  padding: 0 1rem 1rem 1rem;\n  margin-top: 0.5rem;\n"])));var B=function(){var e,n,t=Object(r.useState)(""),a=Object(j.a)(t,2),o=a[0],c=a[1],s=Object(r.useState)(""),i=Object(j.a)(s,2),l=i[0],d=i[1],u=v(),b=u.login,m=u.loginAnonymous,g=u.user,O=(null===(e=window.location.state)||void 0===e||null===(n=e.from)||void 0===n?void 0:n.pathname)||"/";return g?Object(h.jsx)(f.a,{to:O,replace:!0}):Object(h.jsxs)(M,{children:[Object(h.jsxs)(T,{children:[Object(h.jsx)(I.a,{style:{marginBottom:"1rem"},children:"Please log in using your credentials"}),Object(h.jsx)(P.a,{label:"Username",placeholder:"your.email@example.com",onChange:function(e){c(e.target.value)},value:o}),Object(h.jsx)(P.a,{label:"Password",type:"password",onChange:function(e){d(e.target.value)},value:l}),Object(h.jsx)(E.c,{style:{marginTop:"1rem"},variant:"primary",onClick:function(){return b(o,l)},children:"Login"})]}),Object(h.jsxs)(q,{children:[Object(h.jsx)(I.a,{style:{marginBottom:"0.5rem"},children:"Or log in as a guest"}),Object(h.jsx)(E.c,{variant:"primaryOutline",onClick:function(){return m()},children:"Login Anonymously"})]})]})};var F,U,W,R,H,N=function(e){var n=e.children,t=v().user,r=Object(f.f)();return t?n:Object(h.jsx)(f.a,{to:"/login",state:{from:r},replace:!0})},J=t(119),K=L.a.header(F||(F=Object(A.a)(["\n  text-align: center;\n"]))),D=L.a.div(U||(U=Object(A.a)(["\n  display: grid;\n  grid-template-columns: 1fr auto 1fr;\n  grid-column-gap: 5px;\n  justify-items: center;\n"]))),G=L.a.div(W||(W=Object(A.a)(["\n  margin-left: auto;\n  text-align: right;\n  padding-right: 0.5rem;\n"]))),Q=Object(c.keyframes)(R||(R=Object(A.a)(["\n  from {\n    transform: rotate(-5deg);\n  }\n  to {\n    transform: rotate(5deg);\n  }\n"]))),V=Object(L.a)(J.a)(H||(H=Object(A.a)(["\n  display: inline-block;\n  margin: 24px;\n  animation: "," 3s infinite alternate-reverse ease-in-out;\n  transform-origin: 50% 100%;\n"])),Q);var X,Y,Z,$=function(){var e=v(),n=e.logout,t=e.user;return Object(h.jsxs)(K,{children:[Object(h.jsxs)(D,{children:[Object(h.jsx)(I.c,{style:{gridColumnStart:2},children:"Amsterdam Billiards League Site"}),t&&Object(h.jsxs)(G,{children:[Object(h.jsx)(I.a,{children:"Logged in as ".concat("anon-user"===t.providerType?"guest":t.profile.email||t.id)}),Object(h.jsx)(E.c,{variant:"primaryOutline",onClick:n,children:"Logout"})]})]}),Object(h.jsx)(V,{height:98})]})},ee=t(38),ne=t(53),te=t(27),re=L.a.div(X||(X=Object(A.a)(["\n  display: flex;\n"]))),ae=L.a.div(Y||(Y=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n"]))),oe=L.a.div(Z||(Z=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n"])));var ce,se=function(e){var n=e.season,t=k().data,a=Object(r.useState)({}),o=Object(j.a)(a,2),c=o[0],s=o[1];return Object(r.useEffect)((function(){t&&n&&Promise.all([t.teamMatches().find({season_code:n.code}),t.teams().find({"season.code":n.code})]).then((function(e){var n=Object(j.a)(e,2),t=n[0],r=n[1],a=t.reduce((function(e,n){var t,r=e[n.left_team.code]||{wins:0,losses:0,gamesWon:0,gamesTotal:0};n.left_team.win?r.wins++:r.losses++,r.gamesWon+=n.left_team.games_won,r.gamesTotal+=n.left_team.games_won+n.right_team.games_won;var a=e[n.right_team.code]||{wins:0,losses:0,gamesWon:0,gamesTotal:0};return n.right_team.win?a.wins++:a.losses++,a.gamesWon+=n.right_team.games_won,a.gamesTotal+=n.right_team.games_won+n.left_team.games_won,Object(b.a)(Object(b.a)({},e),{},(t={},Object(u.a)(t,n.left_team.code,r),Object(u.a)(t,n.right_team.code,a),t))}),{}),o=r.reduce((function(e,n){return Object(b.a)(Object(b.a)({},e),{},Object(u.a)({},n.division_name,[].concat(Object(ne.a)(e[n.division_name]||[]),[n])))}),{});s(Object.entries(o).reduce((function(e,n){var t=Object(j.a)(n,2),r=t[0],o=t[1].map((function(e){var n=a[e.key];return Object(b.a)(Object(b.a)({},e),{},{rank:0,wins:n.wins,losses:n.losses,pct:n.gamesWon/n.gamesTotal})}));return o.sort((function(e,n){return e.wins===n.wins?e.losses===n.losses?n.pct-e.pct:e.losses-n.losses:n.wins-e.wins})),Object(b.a)(Object(b.a)({},e),{},Object(u.a)({},r,o.map((function(e,n){return Object(b.a)(Object(b.a)({},e),{},{rank:n+1})}))))}),{}))}))}),[n]),t?Object(h.jsx)(re,{children:n.leagues.map((function(e){return Object(h.jsx)(ae,{children:n.divisions[e].map((function(e){return Object(h.jsx)(oe,{children:c[e]&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(I.d,{children:e}),Object(h.jsx)(te.c,{data:c[e],columns:[Object(h.jsx)(te.d,{label:"Place"}),Object(h.jsx)(te.d,{label:"Team Name"}),Object(h.jsx)(te.d,{label:"W's"}),Object(h.jsx)(te.d,{label:"L's"}),Object(h.jsx)(te.d,{label:"PCT."})],children:function(e){var n=e.datum;return Object(h.jsxs)(te.b,{children:[Object(h.jsx)(te.a,{children:n.rank}),Object(h.jsx)(te.a,{children:n.name}),Object(h.jsx)(te.a,{children:n.wins}),Object(h.jsx)(te.a,{children:n.losses}),Object(h.jsx)(te.a,{children:n.pct.toFixed(3)})]},n.key)}})]})},e)}))},e)}))}):null},ie=L.a.div(ce||(ce=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 12px;\n  justify-content: center;\n"])));var le,de,ue,be,je,fe=function(e){var n=e.seasons,t=Object(r.useState)(),a=Object(j.a)(t,2),o=a[0],c=a[1];return Object(h.jsxs)(ie,{children:[Object(h.jsx)(ee.b,{style:{width:"360px"},label:"Choose a season:",placeholder:"Select...",value:(null===o||void 0===o?void 0:o.name)||"",onChange:function(e){return c(n.find((function(n){return n.name===e})))},children:n.map((function(e){var n=e.code,t=e.name;return Object(h.jsx)(ee.a,{value:t,children:t},n)}))}),o&&Object(h.jsx)(se,{season:o})]})},me=function(e){var n=e.user;return Object(h.jsx)("div",{children:Object(h.jsxs)("h1",{children:["Logged in with anonymous id: ",n.id]})})},ge=function(){var e=v().loginAnonymous;return Object(h.jsx)("button",{onClick:e,children:"Log In"})},Oe=t.p+"static/media/logo.6ce24c58.svg",he=L.a.div(le||(le=Object(A.a)(["\n  text-align: center;\n"]))),pe=L.a.header(de||(de=Object(A.a)(["\n  background-color: ",";\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: calc(10px + 2vmin);\n  color: ",";\n"])),(function(e){return e.theme.colors.grays.base}),(function(e){return e.theme.colors.white})),xe=L.a.a(ue||(ue=Object(A.a)(["\n  color: ",";\n"])),(function(e){return e.theme.colors.blues.light1})),ve=Object(c.keyframes)(be||(be=Object(A.a)(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]))),ye=L.a.img(je||(je=Object(A.a)(["\n  height: 40vmin;\n  pointer-events: none;\n  @media (prefers-reduced-motion: no-preference) {\n    animation: "," infinite 20s linear;\n  }\n"])),ve);var we,ke=function(){var e=v().user;return Object(h.jsx)(he,{children:Object(h.jsxs)(pe,{children:[Object(h.jsx)(ye,{src:Oe,alt:"logo"}),Object(h.jsxs)("p",{children:["Edit ",Object(h.jsx)("code",{children:"src/sandbox/sandbox.tsx"})," and save to reload."]}),Object(h.jsx)(xe,{href:"https://reactjs.org",target:"_blank",rel:"noopener noreferrer",children:"Learn React"}),e?Object(h.jsx)(me,{user:e}):Object(h.jsx)(ge,{})]})})},ze=L.a.div(we||(we=Object(A.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 12px;\n  justify-content: center;\n"])));var Ce=function(e){var n=e.seasons,t=e.teams,a=k().data,o=Object(r.useState)(),c=Object(j.a)(o,2),s=c[0],i=c[1],l=Object(r.useState)(),d=Object(j.a)(l,2),u=d[0],b=d[1];return a?Object(h.jsxs)(ze,{children:[Object(h.jsx)(ee.b,{style:{width:"360px"},label:"Choose a season:",placeholder:"Select...",onChange:function(e){if(!e)return i(void 0),void b(void 0);i(parseInt(e,10))},children:n.map((function(e){var n=e.code,t=e.name;return Object(h.jsx)(ee.a,{value:""+n,children:t},n)}))}),s&&Object(h.jsx)(ee.b,{style:{width:"360px"},label:"Choose a team:",placeholder:"Select...",onChange:function(e){b(e?parseInt(e,10):void 0)},children:t.filter((function(e){return e.season.code===s})).map((function(e){var n=e.key,t=e.name;return Object(h.jsx)(ee.a,{value:""+n,children:t},n)}))}),u&&Object(h.jsx)(h.Fragment,{children:"team data"})]}):null};var Se,_e,Ae=function(){var e=k().data,n=Object(r.useState)([]),t=Object(j.a)(n,2),a=t[0],o=t[1];Object(r.useEffect)((function(){e&&e.seasons().find().then(o)}));var c=Object(r.useState)({list:[],byKey:{}}),s=Object(j.a)(c,2),i=s[0],l=s[1];return Object(r.useEffect)((function(){e&&e.teams().find().then((function(e){return l({list:e,byKey:e.reduce((function(e,n){return Object(b.a)(Object(b.a)({},e),{},Object(u.a)({},n.key,n))}),{})})}))}),[e]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)($,{}),Object(h.jsxs)(f.d,{children:[Object(h.jsx)(f.b,{path:"/",element:Object(h.jsx)(N,{children:Object(h.jsx)(fe,{seasons:a})})}),Object(h.jsx)(f.b,{path:"team",element:Object(h.jsx)(N,{children:Object(h.jsx)(Ce,{seasons:a,teams:i.list})})}),Object(h.jsx)(f.b,{path:"login",element:Object(h.jsx)(B,{})}),Object(h.jsx)(f.b,{path:"sandbox",element:Object(h.jsx)(ke,{})})]})]})},Le=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,238)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),r(e),a(e),o(e),c(e)}))},Ee="".concat("https://d2va9gm4j17fy9.cloudfront.net","/fonts"),Pe=Object(c.css)(Se||(Se=Object(A.a)(["\n  @font-face {\n    font-family: 'Akzidenz';\n    font-weight: normal;\n    src: url('","/akzidgrostdreg.eot');\n    /* IE9 Compat Modes */\n    src: url('","/akzidgrostdreg.eot?#iefix')\n        format('embedded-opentype'),\n      /* Pretty Modern Browsers */ url('","/akzidgrostdreg.ttf')\n        format('truetype'),\n      /* Safari, Android, iOS */ url('","/akzidgrostdreg.svg#Akzidenz')\n        format('svg');\n    /* Legacy iOS */\n  }\n\n  @font-face {\n    font-family: 'Akzidenz';\n    font-weight: 600;\n    src: url('","/akzidgrostdmed.eot');\n    /* IE9 Compat Modes */\n    src: url('","/akzidgrostdmed.eot?#iefix')\n        format('embedded-opentype'),\n      /* IE6-IE8 */ url('","/akzidgrostdmed.woff') format('woff'),\n      /* Pretty Modern Browsers */ url('","/akzidgrostdmed.ttf')\n        format('truetype'),\n      /* Safari, Android, iOS */ url('","/akzidgrostdmed.svg#Akzidenz')\n        format('svg');\n    /* Legacy iOS */\n  }\n\n  @font-face {\n    font-family: 'Akzidenz';\n    font-weight: bold;\n    src: url('","/akzidgrostdmed.eot');\n    /* IE9 Compat Modes */\n    src: url('","/akzidgrostdmed.eot?#iefix')\n        format('embedded-opentype'),\n      /* IE6-IE8 */ url('","/akzidgrostdmed.woff') format('woff'),\n      /* Pretty Modern Browsers */ url('","/akzidgrostdmed.ttf')\n        format('truetype'),\n      /* Safari, Android, iOS */ url('","/akzidgrostdmed.svg#Akzidenz')\n        format('svg');\n    /* Legacy iOS */\n  }\n\n  html {\n    font-family: 'Akzidenz', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n    font-weight: normal;\n    font-style: normal;\n  }\n\n  body {\n    margin: 0;\n  }\n\n  *,\n  *:before,\n  *:after {\n    box-sizing: border-box;\n  }\n"])),Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee,Ee),Ie=Object(c.css)(_e||(_e=Object(A.a)(["\n/* http://meyerweb.com/eric/tools/css/reset/\n   v2.0 | 20110126\n   License: none (public domain)\n*/\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed,\nfigure, figcaption, footer, header, hgroup,\nmenu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure,\nfooter, header, hgroup, menu, nav, section {\n\tdisplay: block;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\n"])));var Me=function(){return[Ie,Pe]},Te={colors:{black:"#000000",white:"#ffffff",offwhite:"#fffed1",grays:{base:"#282c34"},reds:{base:"#4d0a05",light1:"#8a1a10",light2:"#b42619",light3:"#df3121"},blues:{light1:"#61dafb"}},typography:{fonts:{code:"source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace"}}};l.a.createRoot(document.getElementById("root")).render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(d.a,{basename:"/amsterdam",children:Object(h.jsx)(x,{children:Object(h.jsx)(w,{children:Object(h.jsx)(s.a,{children:Object(h.jsxs)(o.f,{theme:Te,children:[Object(h.jsx)(c.Global,{styles:Me}),Object(h.jsx)(Ae,{})]})})})})})})),Le(console.log)}},[[235,1,2]]]);
//# sourceMappingURL=main.52cc047b.chunk.js.map